{% extends 'main/detail_base.html' %}
{% block title %}
    {% if form.initial %}
        步骤详情 - {{ form.initial.name }}
    {% else %}
        步骤详情 - 添加
    {% endif %}
{% endblock %}
{% block script %}
<script>
    $(function () {
        // 更新导航栏
        $('#nav_step').addClass('active');
        // 触发展示Action相关内容
        showActionField($('#id_action'));
        // 注册Action变更
        $('#id_action').off('change').change(function () {
            showActionField($(this));
        });
        // 展示Action相关内容
        function showActionField($actionSelect) {
            if ($actionSelect.find('option:selected').text().indexOf('UI') == 0) {
                $('div[action_type="ui"]').show()
                $('div[action_type="api"]').hide()
                $('div[action_type="db"]').hide()
            } else if ($actionSelect.find('option:selected').text().indexOf('API') == 0) {
                $('div[action_type="ui"]').hide()
                $('div[action_type="api"]').show()
                $('div[action_type="db"]').hide()
            } else if ($actionSelect.find('option:selected').text().indexOf('DB') == 0) {
                $('div[action_type="ui"]').hide()
                $('div[action_type="api"]').hide()
                $('div[action_type="db"]').show()
            } else {
                $('div[action_type="ui"]').hide()
                $('div[action_type="api"]').hide()
                $('div[action_type="db"]').hide()
            }
        }
    })
</script>
{% endblock %}

{% block detail_header %}
<ol class="breadcrumb my-4">
    <li class="breadcrumb-item active">
    {% if form.initial %}
        该步骤目前被<abbr title="{% for o in related_objects %}【{{ o }}】{% if not forloop.last %}，{% endif %}{% endfor %}">{{ related_objects|length }}个</abbr>用例调用，创建时间：{{ obj.created_date }}，创建人：{{ obj.creator }}，上次修改时间：{{ obj.modified_date }}，修改人：{{ obj.modifier }}
    {% else %}
        添加一个步骤
    {% endif %}
    </li>
</ol>
{% endblock %}

{% block detail_content %}
<div class="row align-items-center">
    <div class="col-1 text-right ">名称</div>
    <div class="col" form_data>
        {{ form.name }}
        {% if form.errors.name.0 %}
            <div class="text-warning">{{ form.errors.name.0 }}</div>
        {% endif %}
    </div>
</div>
<div class="row align-items-center">
    <div class="col-1 text-right">描述</div>
    <div class="col" form_data>
        {{ form.description }}
        {% if form.errors.description.0 %}
            <div class="text-warning">{{ form.errors.description.0 }}</div>
        {% endif %}
    </div>
</div>
<div class="row align-items-center">
    <div class="col-1 text-right">关键字</div>
    <div class="col" form_data>
        {{ form.keyword }}
        {% if form.errors.keyword.0 %}
            <div class="text-warning">{{ form.errors.keyword.0 }}</div>
        {% endif %}
    </div>
</div>
<div class="row align-items-center">
    <div class="col-1 text-right">动作</div>
    <div class="col" form_data>
        {{ form.action }}
        {% if form.errors.action.0 %}
            <div class="text-warning">{{ form.errors.action.0 }}</div>
        {% endif %}
    </div>
</div>
<div class="row align-items-center">
    <div class="col-1 text-right">超时</div>
    <div class="col" form_data>
        {{ form.timeout }}
        {% if form.errors.timeout.0 %}
            <div class="text-warning">{{ form.errors.timeout.0 }}</div>
        {% endif %}
    </div>
</div>
<div class="row align-items-center">
    <div class="col-1 text-right">结果另存</div>
    <div class="col mx-auto" form_data>
        {{ form.save_as }}
        {% if form.errors.save_as.0 %}
            <div class="text-warning">{{ form.errors.save_as.0 }}</div>
        {% endif %}
    </div>
</div>
<div class="row align-items-center" action_type="ui">
    <div class="col-1 text-right">定位方式</div>
    <div class="col" form_data>
        {{ form.ui_by }}
        {% if form.errors.ui_by.0 %}
            <div class="text-warning">{{ form.errors.ui_by.0 }}</div>
        {% endif %}
    </div>
</div>
<div class="row align-items-center" action_type="ui">
    <div class="col-1 text-right">定位值</div>
    <div class="col" form_data>
        {{ form.ui_locator }}
        {% if form.errors.ui_locator.0 %}
            <div class="text-warning">{{ form.errors.ui_locator.0 }}</div>
        {% endif %}
    </div>
</div>
<div class="row align-items-center" action_type="ui">
    <div class="col-1 text-right">索引</div>
    <div class="col" form_data>
        {{ form.ui_index }}
        {% if form.errors.ui_index.0 %}
            <div class="text-warning">{{ form.errors.ui_index.0 }}</div>
        {% endif %}
    </div>
</div>
<div class="row align-items-center" action_type="ui">
    <div class="col-1 text-right">基元素</div>
    <div class="col" form_data>
        {{ form.ui_base_element }}
        {% if form.errors.ui_base_element.0 %}
            <div class="text-warning">{{ form.errors.ui_base_element.0 }}</div>
        {% endif %}
    </div>
</div>
<div class="row align-items-center" action_type="ui">
    <div class="col-1 text-right">数据</div>
    <div class="col" form_data>
        {{ form.ui_data }}
        {% if form.errors.ui_data.0 %}
            <div class="text-warning">{{ form.errors.ui_data.0 }}</div>
        {% endif %}
    </div>
</div>
<div class="row align-items-center" action_type="ui">
    <div class="col-1 text-right">特殊动作</div>
    <div class="col" form_data>
        {{ form.ui_special_action }}
        {% if form.errors.ui_special_action.0 %}
            <div class="text-warning">{{ form.errors.ui_special_action.0 }}</div>
        {% endif %}
    </div>
</div>
<div class="row align-items-center" action_type="ui">
    <div class="col-1 text-right">浏览器弹出处理</div>
    <div class="col" form_data>
        {{ form.ui_alert_handle }}
        {% if form.errors.ui_alert_handle.0 %}
            <div class="text-warning">{{ form.errors.ui_alert_handle.0 }}</div>
        {% endif %}
    </div>
</div>
<div class="row align-items-center" action_type="api">
    <div class="col-1 text-right">请求地址</div>
    <div class="col" form_data>
        {{ form.api_url }}
        {% if form.errors.api_url.0 %}
            <div class="text-warning">{{ form.errors.api_url.0 }}</div>
        {% endif %}
    </div>
</div>
<div class="row align-items-center" action_type="api">
    <div class="col-1 text-right">请求 Headers</div>
    <div class="col" form_data>
        {{ form.api_headers }}
        {% if form.errors.api_headers.0 %}
            <div class="text-warning">{{ form.errors.api_headers.0 }}</div>
        {% endif %}
    </div>
</div>
<div class="row align-items-center" action_type="api">
    <div class="col-1 text-right">请求 Body</div>
    <div class="col" form_data>
        {{ form.api_body }}
        {% if form.errors.api_body.0 %}
            <div class="text-warning">{{ form.errors.api_body.0 }}</div>
        {% endif %}
    </div>
</div>
<div class="row align-items-center" action_type="api">
    <div class="col-1 text-right">验证内容</div>
    <div class="col" form_data>
        {{ form.api_data }}
        {% if form.errors.api_data.0 %}
            <div class="text-warning">{{ form.errors.api_data.0 }}</div>
        {% endif %}
    </div>
</div>
<br/>
<div class="save_button_group fixed-bottom">
    <table>
        <tr>
            <td><input type="submit" value="提交" class="btn btn-primary"></td>
            <td><input type="reset" value="还原" class="btn btn-secondary"></td>
            <td><input type="button" value="关闭" onclick="window.close();" class="btn btn-danger"></td>
        </tr>
    </table>
</div>
{% endblock %}